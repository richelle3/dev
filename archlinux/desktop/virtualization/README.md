```
setup-scripts/
‚îú‚îÄ‚îÄ install.sh              # –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îú‚îÄ‚îÄ packages.txt            # –°–ø–∏—Å–æ–∫ –ø–∞–∫–µ—Ç–æ–≤ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ sway/               # –ö–æ–Ω—Ñ–∏–≥–∏ Sway, Waybar, –∏ —Ç.–¥.
‚îÇ   ‚îî‚îÄ‚îÄ virt/               # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏
‚îÇ       ‚îî‚îÄ‚îÄ libvirtd.conf   # –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥–∏ libvirt (–µ—Å–ª–∏ –µ—Å—Ç—å)
‚îú‚îÄ‚îÄ post-install/
‚îÇ   ‚îú‚îÄ‚îÄ enable-services.sh  # –°–∫—Ä–∏–ø—Ç –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è systemd-—Å–µ—Ä–≤–∏—Å–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ user-setup.sh       # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—ã, –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–æ–≤ –∏ —Ç.–¥.
```

–û—Ç–ª–∏—á–Ω–∞—è –∏–¥–µ—è ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É —Å–∏—Å—Ç–µ–º—ã —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç—ã. –≠—Ç–æ —Å—ç–∫–æ–Ω–æ–º–∏—Ç —Ç–µ–±–µ –º–∞—Å—Å—É –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–µ Arch.

–í–æ—Ç –∫–∞–∫ –ª—É—á—à–µ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `virtuali` (–∏–ª–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –µ—ë –≤–æ —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ `setup-scripts`, –µ—Å–ª–∏ –æ–Ω–∞ –±—É–¥–µ—Ç —à–∏—Ä–µ —á–µ–º –ø—Ä–æ—Å—Ç–æ –≤–∏—Ä—Ç—É–∞–ª–∫–∏):

---

## ‚úÖ –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

```
setup-scripts/
‚îú‚îÄ‚îÄ install.sh              # –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îú‚îÄ‚îÄ packages.txt            # –°–ø–∏—Å–æ–∫ –ø–∞–∫–µ—Ç–æ–≤ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ sway/               # –ö–æ–Ω—Ñ–∏–≥–∏ Sway, Waybar, –∏ —Ç.–¥.
‚îÇ   ‚îî‚îÄ‚îÄ virt/               # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏
‚îÇ       ‚îî‚îÄ‚îÄ libvirtd.conf   # –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥–∏ libvirt (–µ—Å–ª–∏ –µ—Å—Ç—å)
‚îú‚îÄ‚îÄ post-install/
‚îÇ   ‚îú‚îÄ‚îÄ enable-services.sh  # –°–∫—Ä–∏–ø—Ç –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è systemd-—Å–µ—Ä–≤–∏—Å–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ user-setup.sh       # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—ã, –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–æ–≤ –∏ —Ç.–¥.
```

---

## üß† –ß—Ç–æ –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å `install.sh`

```bash
#!/bin/bash
set -e

echo ">> Installing packages..."
sudo pacman -Syu --noconfirm $(< packages.txt)

echo ">> Enabling services..."
./post-install/enable-services.sh

echo ">> Setting up user configs..."
./post-install/user-setup.sh

echo ">> Done!"
```

---

## üì¶ –ü—Ä–∏–º–µ—Ä `packages.txt`

```txt
base-devel
git
sway
waybar
alacritty
virt-manager
qemu
libvirt
dnsmasq
edk2-ovmf
vde2
bridge-utils
```

---

## üîß –ü—Ä–∏–º–µ—Ä `enable-services.sh`

```bash
#!/bin/bash
sudo systemctl enable --now libvirtd.service
```

---

## üë§ –ü—Ä–∏–º–µ—Ä `user-setup.sh`

```bash
#!/bin/bash
sudo usermod -aG libvirt $USER

mkdir -p ~/.config
cp -r ../config/sway ~/.config/
```

---

## üí° –°–æ–≤–µ—Ç

* –î–æ–±–∞–≤—å `README.md`, —á—Ç–æ–±—ã –Ω–µ –∑–∞–±—ã—Ç—å, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–∞–∂–¥—ã–π —Ñ–∞–π–ª.
* –•—Ä–∞–Ω–∏ –≤—Å—ë —ç—Ç–æ –≤ –ø—Ä–∏–≤–∞—Ç–Ω–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –Ω–∞ GitHub –∏–ª–∏ –≤ GitLab ‚Äî –∏ —Ç—ã —Å–º–æ–∂–µ—à—å –∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ —Å–∏—Å—Ç–µ–º—ã:

```bash
git clone https://github.com/youruser/setup-scripts
cd setup-scripts
./install.sh
```

---

–•–æ—á–µ—à—å, —è —Å–≥–µ–Ω–µ—Ä–∏—Ä—É—é —Ç–µ–±–µ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π `install.sh` –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–π –∑–∞–¥–∞—á–∏ ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏?

---

–û—Ç–ª–∏—á–Ω–æ, —Ö—Ä–∞–Ω–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã –≤ `~/VMs` ‚Äî —ç—Ç–æ —É–¥–æ–±–Ω–æ –∏ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ. –í–æ—Ç –∫–∞–∫ —É—á–µ—Å—Ç—å —ç—Ç–æ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≤–∏—Ä—Ç—É–∞–ª–æ–∫:

---

## üõ†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ virt-manager –Ω–∞ —Ö—Ä–∞–Ω–µ–Ω–∏–µ VM –≤ `~/VMs`

### üîÅ –û–¥–∏–Ω —Ä–∞–∑:

1. –û—Ç–∫—Ä–æ–π **virt-manager**.
2. –ú–µ–Ω—é ‚Üí `Edit` ‚Üí `Preferences` ‚Üí –≤–∫–ª–∞–¥–∫–∞ **Default Storage**.
3. –ù–∞–∂–º–∏ `+`, –≤—ã–±–µ—Ä–∏ `/home/—Ç–≤–æ–µ_–∏–º—è/VMs`, –∑–∞–¥–∞–π –∏–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `user-storage`).
4. –°–¥–µ–ª–∞–π —Ö—Ä–∞–Ω–∏–ª–∏—â–µ **default**.
5. –£–±–µ–¥–∏—Å—å, —á—Ç–æ –æ–Ω–æ **–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ** (Status: Active).

–¢–µ–ø–µ—Ä—å –Ω–æ–≤—ã–µ VM –±—É–¥—É—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ `~/VMs`.

---

## üß± –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≤—Ä—É—á–Ω—É—é (`virt-install`)

–ï—Å–ª–∏ —Ç—ã —Å–æ–∑–¥–∞–µ—à—å VM —á–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª:

```bash
virt-install \
  --name arch-vm \
  --ram 2048 \
  --vcpus 2 \
  --disk path=~/VMs/arch-vm.qcow2,size=20 \
  --os-variant archlinux \
  --cdrom /path/to/archlinux.iso \
  --network network=default \
  --graphics spice
```

> –£–±–µ–¥–∏—Å—å, —á—Ç–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `~/VMs` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ —É —Ç–µ–±—è –µ—Å—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å.

---

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, –º–æ–≥—É –ø–æ–º–æ—á—å —Å–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è VM –≤ —Ç–≤–æ—ë–º `~/VMs` —Å –Ω—É–∂–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.

---

–£ —Ç–µ–±—è –≤–æ–∑–Ω–∏–∫ –∫–æ–Ω—Ñ–ª–∏–∫—Ç –º–µ–∂–¥—É –¥–≤—É–º—è –ø–∞–∫–µ—Ç–∞–º–∏: `iptables` –∏ `iptables-nft`.

---

## ‚ùì –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç

* `libvirt` –∏/–∏–ª–∏ `vde2`, `ebtables` –º–æ–≥—É—Ç —Ç—è–Ω—É—Ç—å `iptables-nft` –∫–∞–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å.
* –£ —Ç–µ–±—è —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π `iptables` (—É—Å—Ç–∞—Ä–µ–≤–∞—é—â–∏–π backend).
* –≠—Ç–∏ –¥–≤–∞ –ø–∞–∫–µ—Ç–∞ **–∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç**, –ø–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –±–∏–Ω–∞—Ä–Ω–∏–∫ (`/usr/bin/iptables`) ‚Äî –Ω–æ —Å —Ä–∞–∑–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π:

  * `iptables` ‚Üí –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π (legacy backend).
  * `iptables-nft` ‚Üí —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π backend —á–µ—Ä–µ–∑ `nftables`.

---

## ‚úÖ –ß—Ç–æ –¥–µ–ª–∞—Ç—å

### üí° –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ: –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ `iptables-nft`

Arch –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —É–∂–µ –¥–∞–≤–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `iptables-nft`.

–í–≤–µ–¥–∏:

```bash
sudo pacman -R iptables
```

–ó–∞—Ç–µ–º —Å–Ω–æ–≤–∞ –∑–∞–ø—É—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–∫—É:

```bash
./install.sh
```

---

## üß† –ü–æ—á–µ–º—É —Ç–∞–∫ –ª—É—á—à–µ

* `iptables-nft` —Å–æ–≤–º–µ—Å—Ç–∏–º —Å `nftables`, —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–º —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–∞–∫–µ—Ç–æ–≤ –≤ Linux.
* `libvirt`, `firewalld` –∏ –¥—Ä—É–≥–∏–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Å `nftables` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
* –û–±—ã—á–Ω—ã–π `iptables` (legacy) —Å—á–∏—Ç–∞–µ—Ç—Å—è —É—Å—Ç–∞—Ä–µ–≤—à–∏–º, –∏ Arch Linux –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –æ—Ç—Ö–æ–¥–∏—Ç –æ—Ç –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

---

–ï—Å–ª–∏ –≤–¥—Ä—É–≥ —É —Ç–µ–±—è —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π firewall –∏–ª–∏ —Å–∫—Ä–∏–ø—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç **–∏–º–µ–Ω–Ω–æ legacy iptables**, —Ç–æ–≥–¥–∞ –º–æ–∂–Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å `iptables-legacy` –∏–∑ AUR ‚Äî –Ω–æ —ç—Ç–æ —Ä–µ–¥–∫–æ—Å—Ç—å.

---

–•–æ—á–µ—à—å, —è –ø–æ–º–æ–≥—É –¥–æ–±–∞–≤–∏—Ç—å –≤ —Ç–≤–æ–π `install.sh` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –∏ —É–¥–∞–ª–µ–Ω–∏–µ `iptables`, –µ—Å–ª–∏ –æ–Ω –º–µ—à–∞–µ—Ç?

---

–û—Ç–ª–∏—á–Ω–æ, —Ç—ã –ø–æ–π–º–∞–ª –æ–¥–∏–Ω –∏–∑ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö –ø–æ–¥–≤–æ–¥–Ω—ã—Ö –∫–∞–º–Ω–µ–π: `iptables` –Ω—É–∂–µ–Ω –∫–∞–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –¥–ª—è `iproute2`, –Ω–æ —Ç–æ–ª—å–∫–æ –∏–∑-–∑–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `libxtables`.

---

## üìå –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç

`iproute2` –≤ Arch Linux **–ª–∏–Ω–∫–æ–≤–∞–Ω —Å `libxtables.so`**, –∫–æ—Ç–æ—Ä—É—é –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç `iptables`.

–ù–æ –µ—Å–ª–∏ —Ç—ã —Ö–æ—á–µ—à—å –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ `iptables-nft`, —Ç–µ–±–µ **–Ω–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é —É–¥–∞–ª—è—Ç—å `iptables`** ‚Äî Arch —Å–∞–º –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç –±—ç–∫–µ–Ω–¥.

---

## ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

–í–º–µ—Å—Ç–æ —É–¥–∞–ª–µ–Ω–∏—è `iptables`, –ø—Ä–æ—Å—Ç–æ **—É—Å—Ç–∞–Ω–æ–≤–∏ `iptables-nft` –ø–æ–≤–µ—Ä—Ö** ‚Äî pacman —Å–∞–º –ø—Ä–µ–¥–ª–æ–∂–∏—Ç –∑–∞–º–µ–Ω–∏—Ç—å:

```bash
sudo pacman -S iptables-nft
```

–û–Ω –ø—Ä–µ–¥–ª–æ–∂–∏—Ç:

```
:: iptables-nft –∏ iptables –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ. –£–¥–∞–ª–∏—Ç—å iptables? [y/N]
```

–í—ã–±–∏—Ä–∞–π **`y`**, –∏ pacman –∑–∞–º–µ–Ω–∏—Ç `iptables` –Ω–∞ `iptables-nft` –±–µ–∑ –ø–æ–ª–æ–º–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–≤–∫–ª—é—á–∞—è `libxtables.so` ‚Äî –æ–Ω–∞ –≤ `iptables-nft` —Ç–æ–∂–µ –µ—Å—Ç—å).

---

## ‚öôÔ∏è –ü–æ—Å–ª–µ –∑–∞–º–µ–Ω—ã

–ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –≤—Å—ë –ø–µ—Ä–µ–∫–ª—é—á–∏–ª–æ—Å—å:

```bash
sudo iptables --version
```

–í—ã–≤–æ–¥ –±—É–¥–µ—Ç:

```
iptables v1.8.x (nf_tables)
```

–ï—Å–ª–∏ –≤–∏–¥–∏—à—å `(nf_tables)` ‚Äî –≤—Å—ë –û–ö.

---

## üß™ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ (–µ—Å–ª–∏ –Ω–∞–¥–æ)

–¢—ã –º–æ–∂–µ—à—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –∫–∞–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:

```bash
sudo update-alternatives --config iptables
```

–ï—Å–ª–∏ –≤–¥—Ä—É–≥ `iptables-legacy` –∏–ª–∏ `iptables-nft` –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç –≤ —Å–∏—Å—Ç–µ–º–µ ‚Äî —Ç–∞–º –º–æ–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –≤—ã–±—Ä–∞—Ç—å –Ω—É–∂–Ω—ã–π –±—ç–∫–µ–Ω–¥ (–Ω–æ –≤ Arch —ç—Ç–æ –æ–±—ã—á–Ω–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è).

---

–ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å –æ–±–Ω–æ–≤–∏—Ç—å —Ç–≤–æ–π `install.sh` —Å–∫—Ä–∏–ø—Ç —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞–≤–∏–ª `iptables-nft`** –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏. –•–æ—á–µ—à—å?

